<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloggie - Post</title>
    <link rel="icon" type="image/x-icon" href="favicon.jpg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <h1><a href="index.html" class="logo">BLOGGIE</a></h1>
            <div class="header-right">
                <nav id="navbar">
                </nav>
            </div>
        </div>
    </header>

    <!-- Post Container -->
    <div class="container">
        <div class="post-page">
            <div class="back-link">
                <a href="index.html">‚Üê Back to Posts</a>
            </div>

            <!-- Loading State -->
            <div id="loadingPost" class="loading">Loading post...</div>

            <!-- Post Content -->
            <div id="postContent" style="display: none;">
                <article class="post-detail">
                    <div class="post-header-detail">
                        <h1 id="postTitle"></h1>
                        <div class="post-meta-detail">
                            <span class="author">By <strong id="postAuthor"></strong></span>
                            <span class="date" id="postDate"></span>
                        </div>
                        <div id="postTags" class="post-tags"></div>
                    </div>

                    <!-- Post Image (if exists) -->
                    <div id="postImageContainer" style="display: none; margin: 1.5rem 0;">
                        <img id="postImage" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                    </div>

                    <div class="post-content-detail" id="postBody"></div>

                    <!-- Post Actions -->
                    <div class="post-actions-detail">
                        <button id="likeBtn" onclick="likePost()" class="action-btn">
                            <span id="likeIcon">ü§ç</span>
                            <span id="likeText">Like</span>
                            <span id="likeCount" class="count">0</span>
                        </button>

                        <div class="reactions-group">
                            <button class="reaction-btn" onclick="reactToPost('üëç')" data-reaction="üëç">
                                üëç <span id="count-üëç">0</span>
                            </button>
                            <button class="reaction-btn" onclick="reactToPost('‚ù§Ô∏è')" data-reaction="‚ù§Ô∏è">
                                ‚ù§Ô∏è <span id="count-‚ù§Ô∏è">0</span>
                            </button>
                            <button class="reaction-btn" onclick="reactToPost('üòÇ')" data-reaction="üòÇ">
                                üòÇ <span id="count-üòÇ">0</span>
                            </button>
                            <button class="reaction-btn" onclick="reactToPost('üò≠')" data-reaction="üò≠">
                                üò≠ <span id="count-üò≠">0</span>
                            </button>
                            <button class="reaction-btn" onclick="reactToPost('üò°')" data-reaction="üò°">
                                üò° <span id="count-üò°">0</span>
                            </button>
                        </div>

                        <!-- Edit/Delete buttons for post author -->
                        <div id="postOwnerActions" class="owner-actions" style="display: none;">
                            <button onclick="editPost()" class="btn-edit">‚úèÔ∏è Edit</button>
                            <button onclick="deletePost()" class="btn-delete">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                </article>

                <!-- Comments Section -->
                <section class="comments-section-detail">
                    <div class="comments-header">
                        <h2>Comments <span id="commentsCount" class="count">0</span></h2>
                    </div>

                    <!-- Add Comment Form -->
                    <div id="addCommentForm" style="display: none;">
                        <div class="comment-form-detail">
                            <textarea id="commentInput" placeholder="Write a comment..." rows="3"></textarea>
                            <button onclick="addComment()" class="btn btn-primary">Post Comment</button>
                        </div>
                    </div>

                    <div id="loginPrompt" class="login-prompt" style="display: none;">
                        <p>Please <a href="auth.html">login</a> to comment</p>
                    </div>

                    <!-- Comments List -->
                    <div id="commentsList" class="comments-list-detail">
                        <!-- Comments will be loaded here -->
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Edit Post Modal -->
    <div id="editPostModal" class="modal">
        <div class="modal-content edit-modal">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2>Edit Post</h2>
            <form id="editPostForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="editPostTitle">Title</label>
                    <input type="text" id="editPostTitle" required>
                </div>
                
                <div class="form-group">
                    <label for="editPostContent">Content</label>
                    <textarea id="editPostContent" rows="10" required></textarea>
                </div>

                <!-- Current Image Display -->
                <div id="currentImageSection" style="display: none; margin-bottom: 1rem;">
                    <label>Current Image:</label>
                    <div style="margin: 0.5rem 0;">
                        <img id="currentPostImage" style="max-width: 200px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    </div>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="removeImageCheckbox">
                        <span>Remove current image</span>
                    </label>
                </div>

                <!-- New Image Upload -->
                <div class="form-group">
                    <label for="editPostImage">Upload New Image (Optional)</label>
                    <input type="file" id="editPostImage" accept="image/*">
                    <small class="form-hint">Max 5MB ‚Ä¢ JPG, PNG, GIF, WebP</small>
                </div>
                
                <div class="form-group">
                    <label for="editPostTags">Tags (comma separated)</label>
                    <input type="text" id="editPostTags" placeholder="e.g., javascript, tutorial, coding">
                </div>
                
                <div class="modal-buttons">
                    <button type="button" onclick="closeEditModal()" class="btn-cancel">Cancel</button>
                    <button type="submit" class="btn-save">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content delete-modal">
            <h2>‚ö†Ô∏è Delete Post?</h2>
            <p>Are you sure you want to delete this post? This action cannot be undone.</p>
            <div class="modal-buttons">
                <button onclick="closeDeleteModal()" class="btn-cancel">Cancel</button>
                <button onclick="confirmDelete()" class="btn-delete">Delete Forever</button>
            </div>
        </div>
    </div>

    <!-- Delete Comment Modal -->
    <div id="deleteCommentModal" class="modal">
        <div class="modal-content delete-modal">
            <h2>‚ö†Ô∏è Delete Comment?</h2>
            <p>Are you sure you want to delete this comment?</p>
            <div class="delete-info">
                <em id="deleteCommentText"></em>
            </div>
            <div class="modal-buttons">
                <button onclick="closeDeleteCommentModal()" class="btn-cancel">Cancel</button>
                <button onclick="confirmDeleteComment()" class="btn-delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Toast Messages -->
    <div id="toastContainer"></div>

    <script src="post.js"></script>
</body>
</html>